<!DOCTYPE html>
<html lang="no">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Quiz - Oscar Kvalo Johansen</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./style.css" />
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3146019535106543"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-md bg-white border-bottom">
      <div class="container">
        <a class="navbar-brand" href="#" id="nav-home">Oscar Kvalo Johansen</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <div class="navbar-nav ms-auto">
            <a class="nav-link" href="#" id="nav-quizzes">Quiz</a>
            <a class="nav-link d-none" href="#" id="nav-admin">Admin</a>
            <div class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
              >
                <span id="nav-user-badge">Gjest</span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end">
                <li id="logout-nav-btn" class="d-none">
                  <button class="dropdown-item">Logg ut</button>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <!-- Header -->
    <header class="py-3 bg-light border-bottom">
      <div class="container">
        <h1 class="h3 text-center m-0">Oscar Kvalø Johansen</h1>
      </div>
    </header>

    <main class="container my-4">
      <!-- Quiz List -->
      <section id="quiz-list-area" class="d-none">
        <div class="row mb-4">
          <div class="col-md-6">
            <h2 class="h4 fw-semibold">Quiz</h2>
          </div>
          <div class="col-md-6 text-end">
            <button id="create-quiz-btn" class="btn btn-primary d-none">
              Opprett quiz
            </button>
          </div>
        </div>
        <div id="quiz-list" class="row g-3">
          <!-- Quizzes loaded here -->
        </div>
      </section>

      <!-- Quiz Creation Form -->
      <section id="quiz-create-area" class="d-none">
        <div class="mb-3">
          <button id="back-to-quizzes-btn" class="btn btn-secondary">
            Tilbake
          </button>
        </div>
        <div class="card card-elev">
          <div class="card-body">
            <h2 class="h4 fw-semibold mb-3">Opprett ny quiz</h2>
            <form id="quiz-create-form" novalidate>
              <div class="mb-3">
                <label for="quiz-title" class="form-label">Tittel</label>
                <input
                  type="text"
                  class="form-control"
                  id="quiz-title"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="quiz-description" class="form-label">
                  Beskrivelse
                </label>
                <textarea
                  class="form-control"
                  id="quiz-description"
                  rows="3"
                ></textarea>
              </div>
              <div id="questions-container" class="mb-3"></div>
              <button
                type="button"
                id="add-question-btn"
                class="btn btn-secondary mb-3"
              >
                Legg til spørsmål
              </button>
              <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">
                  Publiser quiz
                </button>
                <button
                  type="button"
                  id="cancel-create-btn"
                  class="btn btn-secondary"
                >
                  Avbryt
                </button>
              </div>
            </form>
            <div id="quiz-create-status" class="mt-3 text-muted small"></div>
          </div>
        </div>
      </section>

      <!-- Quiz Taking Area -->
      <section id="quiz-take-area" class="d-none">
        <div class="mb-3">
          <button id="back-to-quizzes-btn2" class="btn btn-secondary">
            Tilbake
          </button>
        </div>
        <div class="card card-elev">
          <div class="card-body">
            <h2 id="quiz-take-title" class="h4 fw-semibold mb-2"></h2>
            <p id="quiz-take-description" class="text-muted small mb-3"></p>

            <!-- Name input (shown only on first attempt) -->
            <div id="quiz-name-section" class="d-none mb-3">
              <label for="quiz-participant-name" class="form-label"
                >Ditt navn</label
              >
              <p class="text-muted small mb-2">
                Du kan bare skrive navn én gang per quiz. Velg navn med omhu!
              </p>
              <div class="input-group">
                <input
                  type="text"
                  class="form-control"
                  id="quiz-participant-name"
                  placeholder="Skriv ditt navn..."
                  required
                />
                <button
                  type="button"
                  class="btn btn-primary"
                  id="quiz-name-confirm-btn"
                >
                  Bekreft
                </button>
              </div>
            </div>

            <!-- Quiz form (shown after name is confirmed) -->
            <form id="quiz-take-form" novalidate class="d-none">
              <div id="quiz-questions-container"></div>
              <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">Send svar</button>
                <button
                  type="button"
                  id="cancel-take-btn"
                  class="btn btn-secondary"
                >
                  Avbryt
                </button>
              </div>
            </form>
            <div id="quiz-take-status" class="mt-3 text-muted small"></div>
          </div>
        </div>
      </section>

      <!-- Results (My answers + answers to my quizzes) -->
      <section id="results-area" class="d-none">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h2 class="h4 fw-semibold m-0">Resultater</h2>
          <button id="results-back-btn" class="btn btn-secondary">
            Tilbake
          </button>
        </div>

        <div class="card card-elev mb-3">
          <div class="card-body">
            <h3 class="h5 fw-semibold mb-2">Mine svar</h3>
            <div id="my-results-container"></div>
          </div>
        </div>

        <div id="my-quiz-results-card" class="card card-elev d-none">
          <div class="card-body">
            <h3 class="h5 fw-semibold mb-2">Svar på mine quiz</h3>
            <div id="my-quiz-results-container"></div>
          </div>
        </div>
      </section>

      <!-- Admin Results -->
      <section id="admin-results-area" class="d-none">
        <h2 class="h4 fw-semibold mb-3">Svar fra brukere</h2>
        <div id="admin-results-container">
          <!-- Results table loaded here -->
        </div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script type="module" src="./Javascript/quiz-app.js"></script>
  </body>
</html>
